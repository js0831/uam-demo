{"version":3,"sources":["./src/app/modules/organization/organization.component.ts","./src/app/modules/organization/organization.component.html","./src/app/modules/organization/organization.module.ts"],"names":[],"mappings":"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","file":"modules-organization-organization-module.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\r\nimport { Store, select } from '@ngrx/store';\r\nimport { setNode, removeNode, addNode, editNode } from '../../store/actions/hierarchy.action';\r\nimport { HierarchyService } from 'src/app/shared/components/hierarchy/hierarchy.service';\r\n\r\nconst FORM_TYPE_ADD = 'FORM_TYPE_ADD';\r\nconst FORM_TYPE_EDIT = 'FORM_TYPE_EDIT';\r\n\r\n@Component({\r\n  selector: 'app-organization',\r\n  templateUrl: './organization.component.html',\r\n  styleUrls: ['./organization.component.scss']\r\n})\r\nexport class OrganizationComponent implements OnInit {\r\n\r\n  private nodeInitialData = {\r\n    name: 'Organization'\r\n  };\r\n\r\n  public node = this.nodeInitialData;\r\n  public editNode = null;\r\n  public addNode = null;\r\n  public showEditModal = false;\r\n  public modalTitle: string;\r\n\r\n  public form: FormGroup;\r\n  private formType: string;\r\n\r\n  constructor(\r\n    private store: Store<{ hierarchy: any}>,\r\n    private formBuilder: FormBuilder,\r\n    private hierarchyService: HierarchyService\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n\r\n    const hierarchy = [\r\n      { id: 10, name: 'Mobile Sales and Marketing', parent_id: null },\r\n      { id: 1, name: 'Consumer Mobile', parent_id: 10 },\r\n      { id: 2, name: 'CSL Marketing & Prepaid ', parent_id: 1 },\r\n      { id: 3, name: 'Marketing Operation', parent_id: 1 },\r\n      { id: 4, name: 'Brand & Communications', parent_id: 1 },\r\n      { id: 5, name: 'Human Resources', parent_id: 1 },\r\n      { id: 6, name: 'Finance', parent_id: 1 },\r\n    ];\r\n\r\n    this.store.dispatch(setNode({ hierarchy }));\r\n\r\n    this.watchHierarchy();\r\n    this.buildForm();\r\n  }\r\n\r\n  public addChild(node): void {\r\n    this.formType = FORM_TYPE_ADD;\r\n    this.addNode = node;\r\n    this.editNode = null;\r\n    this.showEditModal = true;\r\n    this.modalTitle = 'Add Organization';\r\n  }\r\n\r\n  public remove(node): void {\r\n    if (node.subNodes && node.subNodes.length > 0) {\r\n      alert('Cannot remove items that has children');\r\n    } else {\r\n      this.store.dispatch(removeNode(node));\r\n    }\r\n  }\r\n\r\n  public edit(node): void {\r\n    this.editNode = node;\r\n    this.addNode = null;\r\n    this.showEditModal = true;\r\n    this.formType = FORM_TYPE_EDIT;\r\n    this.form.get('name').setValue(node.name);\r\n    this.form.get('description').setValue(node.description || '');\r\n    this.modalTitle = 'Edit Organization';\r\n  }\r\n\r\n  public submitForm(): void {\r\n    if (this.formType === FORM_TYPE_EDIT) {\r\n      this.doEditNode();\r\n    }\r\n    if (this.formType === FORM_TYPE_ADD) {\r\n      this.doAddNode();\r\n    }\r\n    this.form.reset();\r\n  }\r\n\r\n  private watchHierarchy(): void {\r\n    this.store.pipe(select('hierarchy')).subscribe(value => {\r\n      this.node = this.hierarchyService.formatOrg(value);\r\n    });\r\n  }\r\n\r\n  private buildForm(): void {\r\n    this.form = this.formBuilder.group({\r\n      name: ['', [Validators.required]],\r\n      description: ''\r\n    });\r\n  }\r\n\r\n  private doAddNode(): void {\r\n    const formValue = this.form.value;\r\n    this.store.dispatch(addNode({\r\n      id: new Date().getTime(),\r\n      parent_id: this.addNode.id,\r\n      name: formValue.name,\r\n      description: formValue.description\r\n    }));\r\n    this.showEditModal = false;\r\n  }\r\n\r\n  private doEditNode(): void {\r\n    const formValue = this.form.value;\r\n    this.store.dispatch(editNode({\r\n      ...this.editNode,\r\n      name: formValue.name,\r\n      description: formValue.description\r\n    }));\r\n    this.showEditModal = false;\r\n  }\r\n\r\n  public closeModal(): void {\r\n    this.showEditModal = false;\r\n    this.form.reset();\r\n  }\r\n}\r\n","<nav aria-label=\"breadcrumb\">\r\n    <ol class=\"breadcrumb\">\r\n        <li class=\"breadcrumb-item active\">Organizations</li>\r\n    </ol>\r\n  </nav>\r\n\r\n<ng-template #nodeTemplate let-node=\"node\">\r\n    <a href=\"javascript:;\">\r\n        <span>{{node.name}}</span>\r\n        <div class=\"node-menu\">\r\n            <app-menu [name]=\"\">\r\n                <div (click)=\"addChild(node)\" class=\"dropdown-item\">Add Child</div>\r\n                <div (click)=\"remove(node)\" class=\"dropdown-item\">Remove</div>\r\n                <div (click)=\"edit(node)\" class=\"dropdown-item\">Edit</div>\r\n            </app-menu>\r\n        </div>\r\n    </a>\r\n</ng-template>\r\n\r\n<div class=\"d-flex justify-content-center\">\r\n    <app-hierarchy [node]=\"node\" [nodeTemplate]=\"nodeTemplate\"></app-hierarchy>\r\n</div>\r\n\r\n<app-modal\r\n    [show]=\"showEditModal\"\r\n    [saveBtn]=\"'Save'\"\r\n    [closeBtn]=\"'Cancel'\"\r\n    [title]=\"modalTitle\"\r\n    (close)=\"closeModal()\"\r\n    (submit)=\"submitForm()\"\r\n>\r\n    <form [formGroup]=\"form\">\r\n        <label *ngIf=\"addNode\"><strong>Parent:</strong> {{addNode.name}}</label>\r\n        <div class=\"form-group\">\r\n            <label>Name</label>\r\n            <input formControlName=\"name\" type=\"text\" class=\"form-control\" placeholder=\"Enter name\">\r\n        </div>\r\n        <div class=\"form-group\">\r\n            <label>Description</label>\r\n            <textarea formControlName=\"description\" type=\"text\" class=\"form-control\" placeholder=\"Enter description ...\"></textarea>\r\n        </div>\r\n    </form>\r\n</app-modal>\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { ReactiveFormsModule } from '@angular/forms';\r\nimport { CommonModule } from '@angular/common';\r\nimport { OrganizationComponent } from './organization.component';\r\nimport { SharedModule } from '../../shared/shared.module';\r\n\r\nconst routes: Routes = [\r\n  { path: '', component: OrganizationComponent }\r\n];\r\n\r\n@NgModule({\r\n  declarations: [OrganizationComponent],\r\n  imports: [\r\n    CommonModule,\r\n    SharedModule,\r\n    ReactiveFormsModule,\r\n    RouterModule.forChild(routes)\r\n  ]\r\n})\r\nexport class OrganizationModule { }\r\n"],"sourceRoot":"webpack:///"}